# -*- coding: utf-8 -*-
"""Project EDA1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1UaKqCnUQn-GoO7WRBvQ3obtLf47ld2nF
"""

mimport pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings('ignore')

from google.colab import files
uploaded=files.upload()

df=pd.read_csv('5 th year project airlines_flights_data.csv')

df.head(16)

df.columns

unique_source_cities = df['source_city'].unique()
print("Unique values in 'source_city' column:")
for city in unique_source_cities:
    print(city)

df.shape

unique_source_cities = df['destination_city'].unique()
print("Unique values in 'destination_city' column:")
for city in unique_source_cities:
    print(city)



source_city_counts = df['source_city'].value_counts()
print("Count of each unique value in 'source_city' column:")
print(source_city_counts)



destination_city_counts = df['destination_city'].value_counts()
print("Count of each unique value in 'destination_city' column:")
print(destination_city_counts)

df.drop(columns='index',inplace=True)

df.shape

df.info()

df.isnull().sum()

plt.figure(figsize=(10,5))
ax =sns.barplot(x=df['airline'].value_counts().index, y=df['airline'].value_counts().values, palette='Greens' )
for container in ax.containers:
    ax.bar_label(container)
plt.xlabel("Airlines")
plt.ylabel("No of Flights")
plt.title("Flight per Airlines")

plt.figure(figsize=(10,5))
sns.histplot(df['price'],kde=True,color='y')
plt.title("Distribution of Flight Prices")
plt.show()

df.columns

plt.figure(figsize=(10,5))
ax =sns.barplot(x=df['source_city'].value_counts().index, y=df['source_city'].value_counts().values, palette='coolwarm' )
for container in ax.containers:
    ax.bar_label(container)
plt.xlabel("Cities")
plt.ylabel("No of Flights")
plt.title("Flight Departing from each cities")



plt.figure(figsize=(10,5))
ax =sns.barplot(x=df['destination_city'].value_counts().index, y=df['destination_city'].value_counts().values, palette='Spectral' )
for container in ax.containers:
    ax.bar_label(container)
plt.xlabel("Cities")
plt.ylabel("No of Flights")
plt.title("Flight Arriving in each cities")

plt.figure(figsize=(15,10))
plt.subplot(2,2,1)
ax=sns.countplot(x=df['stops'])
for i in ax.containers:
    ax.bar_label(i)
plt.title('Distribution Of No. Of Stops Of The Flight In The Dataset')

plt.figure(figsize=(15,10))
plt.subplot(2,2,2)
ax=sns.countplot(x=df['departure_time'])
for i in ax.containers:
    ax.bar_label(i)
plt.title('Distribution Of The Departure Times Of The Flight In The Dataset')

plt.figure(figsize=(5,10))
plt.subplot(2,2,3)
ax=sns.countplot(x=df['class'])
for i in ax.containers:
    ax.bar_label(i)
plt.title('Distribution Of The Classes Of The Flight In The Dataset')

plt.figure(figsize=(15,8))
plt.subplot(2,2,4)
ax=sns.countplot(x=df['arrival_time'])
for i in ax.containers:
    ax.bar_label(i)
plt.title('Distribution Of The Arrival Time Of The Flight In The Dataset')

df['route']=df['source_city']+"-"+df['destination_city']
plt.figure(figsize=(20,10))
ax =sns.barplot(x=df['route'].value_counts().sort_values(ascending=False)[:10].index, y=df['route'].value_counts().sort_values(ascending=False)[:10].values )
for container in ax.containers:
    ax.bar_label(container)
plt.xlabel("Routes")
plt.ylabel("No of Flights")
plt.title("Top-10 most Popular Routes")

df.shape

df.columns

price_by_daysleft=df.groupby('days_left')['price'].mean().reset_index()

plt.figure(figsize=(15,6))
plt.title('No. Of Days Left To Departure vs Price')
plt.scatter(x=price_by_daysleft['days_left'],y=price_by_daysleft['price'],c='red',marker='*')
sns.lineplot(x=price_by_daysleft['days_left'],y=price_by_daysleft['price'])
plt.show()

departure_time_counts = df['departure_time'].value_counts()

plt.figure(figsize=(8, 8))
plt.pie(departure_time_counts, labels=departure_time_counts.index, autopct='%1.1f%%', startangle=140, colors=sns.color_palette('viridis', len(departure_time_counts)))
plt.title('Distribution of Departure Time')
plt.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.
plt.show()

df.columns

arrival_time_counts = df['arrival_time'].value_counts()

plt.figure(figsize=(8, 8))
plt.pie(arrival_time_counts, labels=arrival_time_counts.index, autopct='%1.1f%%', startangle=140, colors=sns.color_palette('plasma', len(arrival_time_counts)))
plt.title('Distribution of Arrival time')
plt.axis('equal')  # Equal aspect ratio ensures that pie is drawn as a circle.
plt.show()

df.columns

df['airline'].unique()

price_by_daysleft_and_airline=df.groupby(['days_left','airline'])['price'].mean().reset_index()
price_by_daysleft_and_airline_filtered=price_by_daysleft_and_airline[(price_by_daysleft_and_airline['days_left'].isin([1,2,3,4,5,10,15,20,25,30,35,40,45,49,50])
                                                                                                                     & (price_by_daysleft_and_airline['airline'].isin(['AirAsia','Air_India','Indigo','Vistara','GO_FIRST','SpiceJet'])))]
plt.figure(figsize=(18,10))
plt.title('Change in Price vs Days Left (by Airline)')
ax=sns.barplot(data=price_by_daysleft_and_airline_filtered,x='days_left',y='price',hue='airline', palette='viridis')

df['route'].unique()

price_by_daysleft_and_class=df.groupby(['days_left','class'])['price'].mean().reset_index()
price_by_daysleft_and_class=price_by_daysleft_and_class[price_by_daysleft_and_class['days_left'].isin([1,2,3,4,5,10,15,20,25,30,35,40,45,49])]
plt.figure(figsize=(18,10))
plt.title('Change in Price vs Days Left (by Class)')
ax=sns.barplot(data=price_by_daysleft_and_class,x='days_left',y='price',hue='class',palette='Spectral')

route_counts = df['route'].value_counts()
print("Count of flights for each route:")
print(route_counts)

display(route_counts.head(7))

df.columns

df['source_city'].unique()

price_by_daysleft_and_route=df.groupby(['days_left','source_city'])['price'].mean().reset_index()
price_by_daysleft_and_route=price_by_daysleft_and_route[price_by_daysleft_and_route['days_left'].isin([1,2,3,4,5,10,15,20,25,30,35,40,45,49])
                                                                                                      & (price_by_daysleft_and_route['source_city'].isin(['Delhi','Mumbai','Bangalore','Kolkata','Hyderabad', 'Chennai' ]))]
plt.figure(figsize=(18,10))
plt.title('Change in Price vs Days Left (by Source City)')
sns.barplot(data=price_by_daysleft_and_route,x='days_left',y='price',hue='source_city',palette='Reds')
plt.show()

df.columns

df['stops'].unique()

price_by_daysleft_and_stops=df.groupby(['days_left','stops'])['price'].mean().reset_index()
price_by_daysleft_and_stops_filtered=price_by_daysleft_and_stops[(price_by_daysleft_and_stops['days_left'].isin([1,2,3,4,5,10,15,20,25,30,35,40,45,49,50])
                                                                                                                     & (price_by_daysleft_and_stops['stops'].isin(['zero', 'one', 'two_or_more'])))]
plt.figure(figsize=(18,10))
plt.title('Change in Price vs Days Left (by Stops)')
ax=sns.barplot(data=price_by_daysleft_and_stops_filtered,x='days_left',y='price',hue='stops', palette='Set1')

plt.figure(figsize=(10,5))
plt.title('Distribution of Duration')
sns.histplot(df[df['duration']<40]['duration'],kde=True,color='violet')

class_counts = df.groupby(['source_city', 'destination_city', 'class']).size().unstack(fill_value=0)

class_counts.plot(kind='bar', figsize=(14,6), color=['green', 'brown'])

plt.title("Flights by Route and Class")
plt.xlabel("Route (Source â†’ Destination)")
plt.ylabel("Number of Flights")
plt.xticks(rotation=90)
plt.legend(title="Class")
plt.show()

plt.figure(figsize=(8,5))
sns.scatterplot(x='duration', y='price', data=df, alpha=0.5, hue='class')
plt.title("Flight Duration vs Price")
plt.xlabel("Duration (hours)")
plt.ylabel("Price")
plt.show()

plt.figure(figsize=(8,5))
sns.scatterplot(x='duration', y='price', data=df, alpha=0.5, hue='airline')
plt.title("Flight Duration vs Price")
plt.xlabel("Duration (hours)")
plt.ylabel("Price")
plt.show()

df.columns

plt.figure(figsize=(8,5))
sns.scatterplot(x='duration', y='price', data=df, alpha=0.5, hue='source_city', palette='Reds')
plt.title("Flight Duration vs Price")
plt.xlabel("Duration (hours)")
plt.ylabel("Price")
plt.show()

plt.figure(figsize=(8,5))
sns.scatterplot(x='duration', y='price', data=df, alpha=0.5, hue='destination_city', palette='Blues')
plt.title("Flight Duration vs Price")
plt.xlabel("Duration (hours)")
plt.ylabel("Price")
plt.show()

route_price = df.groupby(['source_city', 'destination_city'])['price'].mean().sort_values(ascending=False)

plt.figure(figsize=(12,6))
route_price[:10].plot(kind='bar', color='pink', label='Top 10 Expensive')
plt.title("Top 10 Expensive Routes by Average Price")
plt.xlabel("Route")
plt.ylabel("Average Price")
plt.xticks(rotation=75)
plt.legend()
plt.show()

plt.figure(figsize=(12,6))
route_price[-10:].plot(kind='bar', color='orange', label='Top 10 Cheapest')
plt.title("Top 10 Cheapest Routes by Average Price")
plt.xlabel("Route")
plt.ylabel("Average Price")
plt.xticks(rotation=75)
plt.legend()
plt.show()

time_price = df.groupby(['departure_time', 'arrival_time'])['price'].mean()

plt.figure(figsize=(10,6))
sns.heatmap(time_price, annot=True, fmt=".0f", cmap="coolwarm")
plt.title("Average Price by Departure and Arrival Time")
plt.xlabel("Arrival Time")
plt.ylabel("Departure Time")
plt.show()

df.drop(columns=['route','flight'],axis=1,inplace=True)

from sklearn.preprocessing import OneHotEncoder
categorical_columns = df.select_dtypes(include=['object']).columns.tolist()
data_modified=pd.get_dummies(df,columns=categorical_columns).replace(True,1.0).replace(False,0.0)

data_modified.head()

df.columns

numerical_cols = ['price', 'days_left', 'duration', ]
correlation_matrix = df[numerical_cols].corr()

plt.figure(figsize=(8, 6))
sns.heatmap(correlation_matrix, annot=True, cmap='PuOr', fmt=".2f")
plt.title('Correlation Heatmap of Price, Days Left, and Duration')
plt.show()

from scipy import stats

# Assuming you have your data in different groups (e.g., lists or arrays)
# Replace these with your actual data for each group
group1_data = [20, 22, 24, 23, 25]
group2_data = [18, 19, 21, 20, 22]
group3_data = [25, 26, 28, 27, 29]

# Perform one-way ANOVA test
f_statistic, p_value = stats.f_oneway(group1_data, group2_data, group3_data)

print(f"F-statistic: {f_statistic}")
print(f"P-value: {p_value}")

# Interpret the results
alpha = 0.05  # Significance level
if p_value < alpha:
    print("Reject the null hypothesis: There is a significant difference in the means of the groups.")
else:
    print("Fail to reject the null hypothesis: There is no significant difference in the means of the groups.")

# Assuming you have generated a plot before this cell
plt.savefig('my_plot.png')
# You can specify different formats like 'jpg', 'pdf', etc.
# plt.savefig('my_plot.jpg')
# plt.savefig('my_plot.pdf')

# Calculate average metrics for each airline
airline_metrics = df.groupby('airline')[['price', 'duration', 'days_left']].mean().reset_index()
display(airline_metrics)

# Import necessary libraries for radar chart
import plotly.express as px

# Create radar chart
fig = px.line_polar(airline_metrics, r='price', theta='airline', line_close=True,
                    title='Average Price by Airline',
                    hover_data={'price':':.2f', 'duration':':.2f', 'days_left':':.2f'})
fig.update_traces(fill='toself')
fig.show()

fig = px.line_polar(airline_metrics, r='duration', theta='airline', line_close=True,
                    title='Average Duration by Airline',
                    hover_data={'price':':.2f', 'duration':':.2f', 'days_left':':.2f'})
fig.update_traces(fill='toself')
fig.show()

fig = px.line_polar(airline_metrics, r='days_left', theta='airline', line_close=True,
                    title='Average Days Left by Airline',
                    hover_data={'price':':.2f', 'duration':':.2f', 'days_left':':.2f'})
fig.update_traces(fill='toself')
fig.show()

"""Seaborn provides a wide range of color palettes. Some commonly used ones include:

**Sequential Palettes:**
- `Blues`, `Greens`, `Reds`, `Purples`, `Oranges` (single hue)
- `viridis`, `plasma`, `inferno`, `magma`, `cividis` (perceptually uniform)

**Diverging Palettes:**
- `coolwarm`, `bwr`, `seismic`, `RdBu`, `PuOr`

**Qualitative Palettes:**
- `tab10`, `tab20`, `Set1`, `Set2`, `Set3`, `Paired`

You can also create custom palettes or use matplotlib colormaps.
"""